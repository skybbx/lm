<!doctype html><html lang=zh-cn><meta charset=utf-8><meta name=renderer content="webkit"><meta name=force-rendering content="webkit"><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><link rel=preconnect href=https://cdn.staticfile.org><meta http-equiv=x-dns-prefetch-control content="on"><link rel=dns-prefetch href=//cdn.staticfile.org><link rel=preload href=/font/notoserifsc-regular-webfont.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/font/merriweather-regular-webfont.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/font/notoserifsc-regular-webfont.woff as=font type=font/woff crossorigin><link rel=preload href=/font/merriweather-regular-webfont.woff as=font type=font/woff crossorigin><title>Waline评论之修改记录</title><meta name=description content="一个简单的博客，一个平凡的博主，用最扑实的话记录最真实的自己！"><meta name=author content="老麦"><link rel=stylesheet href=https://iamlm.com/scss/laomai.min.3cbb70297d00f4d336656b3d3bbb01864cb8305db5dd18fe9938ead30ab76e60.css integrity="sha256-PLtwKX0A9NM2ZWs9O7sBhky4MF213Rj+mTjq0wq3bmA=" rel="preload stylesheet" as=style><link rel=stylesheet href=https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css><body style=background:url(https://laomai.org/wp-content/uploads/2022/04/sea-gc05b59c74_1920.jpg);background-size:cover;background-attachment:fixed><div class=container><div class=main-container><div class=tabs-main><input type=checkbox id=menu-btn>
<label for=menu-btn class=menu-icon><i class="fa fa-bars" aria-hidden=true></i></label><div class=main-header><div class=logo><img src=https://laomai.org/wp-content/uploads/2021/04/apple-touch-icon.png alt=老麦></div><div class=logo-con><p>一个简单的博客，一个平凡的博主，用最扑实的话记录最真实的自己！</div><div class=line1></div></div><div class=menu><ul class=tabs><li class=menu-item><a href=/>首页</a><li class=menu-item><a href=/archives/>文章</a><li class=menu-item><a href=/bb/>闲言</a><li class=menu-item><a href=/about/>关于</a><li class=menu-item><a href=/links/>友链</a></ul></div><div class=post-toc><nav id=TableOfContents><ol><li><a href=#waline评论昵称不能少于3个字符>Waline评论昵称不能少于3个字符</a><ol><li><a href=#环境准备>环境准备</a><li><a href=#重构waline-client>重构Waline Client</a><li><a href=#引用新的客户端>引用新的客户端</a></ol><li><a href=#gravatar头像>Gravatar头像</a><ol><li><a href=#waline上更换头像cdn>Waline上更换头像CDN</a><li><a href=#wordpress上更换头像cdn>Wordpress上更换头像CDN</a></ol></ol></nav></div><div class=main-footer><p>&copy;2022老麦</p><span>已记录<span>109905</span>个字</span></div></div><div class=main-content><div class=content-header><h1>Waline评论之修改记录</h1></div><div class=line2><div class=post-time><time datetime=2021-08-15T00:00:00>2021-08-15</time></div></div><div class="content ahover"><p>依稀记得2016年中时我购买了人生第一台（也是唯一一台）锤子手机——Smartisan T2。当时是受了一个同事的蛊惑，但使用没多久就在一次醉酒后丢失了。与锤子手机的这次短暂相会，让我知道了一个折腾牛人，就是锤子科技的创始人——罗永浩。<blockquote><p>我不是为了输赢，我就是认真。</blockquote><p>《生命不息 折腾不止》——当你试图放弃一个你知道是正确的事情的时候，希望你能看看这本书。这是一个理想主义者的奋斗。<p>也许受老罗影响吧，一直以来我都挺爱折腾的。<h2 id=waline评论昵称不能少于3个字符>Waline评论昵称不能少于3个字符</h2><p>部署好Waline后我在本地测试时发现一个个人觉得比较奇怪的问题，我输入昵称“老麦”并进行评论时提示一个错误，「昵称不能少于3个字符」。老实说，这个我还是有点不能理解的，Waline作者不知为何会作出这样的限制，毕竟用两个中文字作为昵称的人还是很多的。<p>试图在官方文档里找这个配置参数，无果，只好选择重新构建Client。<h3 id=环境准备>环境准备</h3><p>安装<a href=https://nodejs.org/en/ target=_blank rel=noopener>Node.js (nodejs.org)</a>，打开官网我们可以找到两个版本进行安装，一个是<code>14.17.5 LTS</code>，另外一个版本则是<code>16.6.2 Current</code>，虽然Node 14默认使用npm@v6，但还是建议安装LTS版本，毕竟稳定才是王道。由于Waline需要用到npm@v7版本，所以如果安装<code>14.17.5 LTS</code>，我们还需要更新一下npm的版本。<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>npm i -g npm
</span></span></code></pre></div><p><strong>拉取项目：</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>git clone https://github.com/walinejs/waline.git
</span></span></code></pre></div><p><strong>安装依赖：</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>// 进入项目目录
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#8be9fd;font-style:italic>cd</span> waline
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>// 安装项目依赖
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>npm i
</span></span></code></pre></div><h3 id=重构waline-client>重构Waline Client</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>// 进入Client目录
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#8be9fd;font-style:italic>cd</span> ./packages/client/
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>// 用VSCode打开该目录
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>code .
</span></span></code></pre></div><p>打开<code>\src\components\CommentBox.vue</code>，搜索<code>// check nick</code>；<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vue data-lang=vue><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#6272a4>// check nick
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#6272a4></span>        <span style=color:#ff79c6>if</span> (
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>          (requiredMeta.indexOf(<span style=color:#f1fa8c>&#39;nick&#39;</span>) <span style=color:#ff79c6>&gt;</span> <span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span> <span style=color:#ff79c6>||</span> comment.nick) <span style=color:#ff79c6>&amp;&amp;</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>          comment.nick.length <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>3</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>        ) {
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>          inputRefs.value.nick<span style=color:#ff79c6>?</span>.focus();
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>          <span style=color:#ff79c6>return</span> alert(locale.value.nickError);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>        }
</span></span></code></pre></div><p>将<code>comment.nick.length &lt; 3</code>修改成<code>comment.nick.length &lt; 2</code>，保存；<p>运行<code>npm run build</code>，这样Waline的客户端就完成构建了。<h3 id=引用新的客户端>引用新的客户端</h3><p>方法很简单，将生成目录<code>dist</code>里的文件git push到Github上，套上Jsdelivr就可以直接引用了。<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#6272a4>// hugo-theme-stack 默认的引入代码
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#6272a4></span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>&lt;script src=&#39;<span style=color:#6272a4>//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js&#39;&gt;&lt;/script&gt;
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#6272a4></span>&lt;div id=<span style=color:#f1fa8c>&#34;waline&#34;</span> class=<span style=color:#f1fa8c>&#34;waline-container&#34;</span>&gt;&lt;<span style=color:#ff79c6>/</span>div&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>&lt;style&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>    .waline<span style=color:#ff79c6>-</span>container {
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>        background<span style=color:#ff79c6>-</span>color: <span style=color:#8be9fd;font-style:italic>var</span>(<span style=color:#ff79c6>--</span>card<span style=color:#ff79c6>-</span>background);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>        border<span style=color:#ff79c6>-</span>radius: <span style=color:#8be9fd;font-style:italic>var</span>(<span style=color:#ff79c6>--</span>card<span style=color:#ff79c6>-</span>border<span style=color:#ff79c6>-</span>radius);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>        box<span style=color:#ff79c6>-</span>shadow: <span style=color:#8be9fd;font-style:italic>var</span>(<span style=color:#ff79c6>--</span>shadow<span style=color:#ff79c6>-</span>l1);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>        padding: <span style=color:#8be9fd;font-style:italic>var</span>(<span style=color:#ff79c6>--</span>card<span style=color:#ff79c6>-</span>padding);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>    .waline<span style=color:#ff79c6>-</span>container .vcount {
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>        color: <span style=color:#8be9fd;font-style:italic>var</span>(<span style=color:#ff79c6>--</span>card<span style=color:#ff79c6>-</span>text<span style=color:#ff79c6>-</span>color<span style=color:#ff79c6>-</span>main);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>&lt;<span style=color:#ff79c6>/</span>style&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>{{<span style=color:#ff79c6>-</span> with .Site.Params.comments.waline <span style=color:#ff79c6>-</span>}}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>{{<span style=color:#ff79c6>-</span> $config <span style=color:#ff79c6>:=</span> dict <span style=color:#f1fa8c>&#34;el&#34;</span> <span style=color:#f1fa8c>&#34;#waline&#34;</span> <span style=color:#f1fa8c>&#34;dark&#34;</span> <span style=color:#f1fa8c>`html[data-scheme=&#34;dark&#34;]`</span> <span style=color:#ff79c6>-</span>}}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>{{<span style=color:#ff79c6>-</span> $replaceKeys <span style=color:#ff79c6>:=</span> dict <span style=color:#f1fa8c>&#34;serverurl&#34;</span> <span style=color:#f1fa8c>&#34;serverURL&#34;</span> <span style=color:#f1fa8c>&#34;requiredmeta&#34;</span> <span style=color:#f1fa8c>&#34;requiredMeta&#34;</span> <span style=color:#f1fa8c>&#34;wordlimit&#34;</span> <span style=color:#f1fa8c>&#34;wordLimit&#34;</span> <span style=color:#f1fa8c>&#34;pagesize&#34;</span> <span style=color:#f1fa8c>&#34;pageSize&#34;</span> <span style=color:#f1fa8c>&#34;avatarcdn&#34;</span> <span style=color:#f1fa8c>&#34;avatarCDN&#34;</span> <span style=color:#f1fa8c>&#34;avatarforce&#34;</span> <span style=color:#f1fa8c>&#34;avatarForce&#34;</span> <span style=color:#ff79c6>-</span>}}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>{{<span style=color:#ff79c6>-</span> <span style=color:#ff79c6>range</span> $key, $val <span style=color:#ff79c6>:=</span> . <span style=color:#ff79c6>-</span>}}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>    {{<span style=color:#ff79c6>-</span> <span style=color:#ff79c6>if</span> $val <span style=color:#ff79c6>-</span>}}  
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>        {{<span style=color:#ff79c6>-</span> $replaceKey <span style=color:#ff79c6>:=</span> index $replaceKeys $key <span style=color:#ff79c6>-</span>}}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>        {{<span style=color:#ff79c6>-</span> $k <span style=color:#ff79c6>:=</span> <span style=color:#ff79c6>default</span> $key $replaceKey <span style=color:#ff79c6>-</span>}}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>        {{<span style=color:#ff79c6>-</span> $config = merge $<span style=color:#50fa7b>config</span> (dict $k $val) <span style=color:#ff79c6>-</span>}}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>    {{<span style=color:#ff79c6>-</span> end <span style=color:#ff79c6>-</span>}}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>{{<span style=color:#ff79c6>-</span> end <span style=color:#ff79c6>-</span>}}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>&lt;script&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>    <span style=color:#6272a4>/// Waline client configuration see: https://waline.js.org/en/reference/client.html
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span><span style=color:#6272a4></span>    new <span style=color:#50fa7b>Waline</span>({{ $config | jsonify | safeJS }});
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>&lt;<span style=color:#ff79c6>/</span>script&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span>{{<span style=color:#ff79c6>-</span> end <span style=color:#ff79c6>-</span>}}
</span></span></code></pre></div><p>将第一行修改为<code>&lt;script src='//cdn.jsdelivr.net/gh/skybbx/img/waline/Waline.min.js'>&lt;/script></code>即可，更多引用方法可以参考官方文档：<a href=https://waline.js.org/guide/client/import.html target=_blank rel=noopener>引入客户端 | Waline</a>。<p>如果你跟我一样只需修改这个昵称字符判定，可以直接引用我修改后的客户端。<p>CDN地址为：<a href=https://cdn.jsdelivr.net/gh/skybbx/img/waline/ target=_blank rel=noopener>https://cdn.jsdelivr.net/gh/skybbx/img/waline/</a><h2 id=gravatar头像>Gravatar头像</h2><p>Gravatar由于被qiang的关系，一直以来我都是使用极客CDN的代理，表现很稳定，可最近这两天却发现开始出问题了，经常出现加载不了的情况。好在这种代理有很多大佬在做，既然不稳定就换一个吧。这次看中的是老庞做的代理。传送门：<a href=https://blog.loli.top/archives/1023.html target=_blank rel=noopener>自建Gravatar国内+全球镜像加速服务 | 城南旧事 (loli.top)</a><h3 id=waline上更换头像cdn>Waline上更换头像CDN</h3><p>因为Waline上Gravatar头像默认的CDN就是极客的，修改方法很简单，查看官方文档——<a href=https://waline.js.org/reference/client.html target=_blank rel=noopener>前端配置 | Waline</a>，定义一个配置<code>avatarCDN</code>即可。案例：<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>&lt;script src=<span style=color:#f1fa8c>&#34;//cdn.jsdelivr.net/gh/skybbx/img/waline/Waline.min.js&#34;</span>&gt;&lt;<span style=color:#ff79c6>/</span>script&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>&lt;div id=<span style=color:#f1fa8c>&#34;waline&#34;</span>&gt;&lt;<span style=color:#ff79c6>/</span>div&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>&lt;script&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>  new <span style=color:#50fa7b>Waline</span>({
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>    el: &#39;#waline&#39;,
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>    serverURL: &#39;客户端地址&#39;,
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>    copyright: <span style=color:#ff79c6>true</span>,
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>    requiredMeta: [&#39;nick&#39;, &#39;mail&#39;],
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>    avatarCDN: &#39;https:<span style=color:#6272a4>//gravatar.loli.top/avatar/&#39;,
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#6272a4></span>  });
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>&lt;<span style=color:#ff79c6>/</span>script&gt;
</span></span></code></pre></div><p>另：可以用<code>{ $config | jsonify | safeJS }</code>将前端的配置集成到Config里。<h3 id=wordpress上更换头像cdn>Wordpress上更换头像CDN</h3><p>将下面代理添加到主题的functions.php即可。<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#6272a4>// gravatar使用 CDN
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#6272a4></span><span style=color:#ff79c6>function</span> <span style=color:#50fa7b>replace_gravatar</span>(<span style=color:#8be9fd;font-style:italic>$avatar</span>) {
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#8be9fd;font-style:italic>$avatar</span> <span style=color:#ff79c6>=</span> str_replace(<span style=color:#ff79c6>array</span>(<span style=color:#f1fa8c>&#34;//gravatar.com/&#34;</span>, <span style=color:#f1fa8c>&#34;//secure.gravatar.com/&#34;</span>, <span style=color:#f1fa8c>&#34;//www.gravatar.com/&#34;</span>, <span style=color:#f1fa8c>&#34;//0.gravatar.com/&#34;</span>, 
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span><span style=color:#f1fa8c>&#34;//1.gravatar.com/&#34;</span>, <span style=color:#f1fa8c>&#34;//2.gravatar.com/&#34;</span>, <span style=color:#f1fa8c>&#34;//cn.gravatar.com/&#34;</span>), <span style=color:#f1fa8c>&#34;//gravatar.loli.top/&#34;</span>, <span style=color:#8be9fd;font-style:italic>$avatar</span>);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span><span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>$avatar</span>;}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>add_filter( <span style=color:#f1fa8c>&#39;get_avatar&#39;</span>, <span style=color:#f1fa8c>&#39;replace_gravatar&#39;</span> );
</span></span></code></pre></div></div><div class="content-tags ahover"><ul><li><a href=/tags/hugo>#hugo</a><li><a href=/tags/waline>#waline</a><li><a href=/tags/stack>#stack</a><li><a href=/tags/jsdelivr>#jsdelivr</a><li><a href=/tags/cdn>#cdn</a><li><a href=/tags/nodejs>#nodejs</a><li><a href=/tags/gravatar>#gravatar</a><li><a href=/tags/npm>#npm</a><li><a href=/tags/wordpress>#Wordpress</a></ul></div><div class=content-footer><script src=//cdn.jsdelivr.net/npm/@waline/client></script><div id=waline class=waline-container></div><style>:root{--waline-font-size:1rem;--waline-theme-color:rgba(0,0,0,0.7);--waline-active-color:#202020;--waline-badge-color:rgba(0,0,0,0.3)}.v[data-class=v] .vcard .vhead .vnick svg{display:none}.v[data-class=v] .vpower{display:none}</style><script>new Waline({avatarCDN:"https://sdn.geekzu.org/avatar/",dark:'html[data-scheme="dark"]',el:"#waline",emoji:["https://cdn.jsdelivr.net/gh/walinejs/emojis/weibo"],lang:"zh-cn",locale:{admin:"⭐"},placeholder:"在这里分享您的观点与想法，昵称、邮箱必填，邮件通知回复。",requiredMeta:["nick","mail"],serverURL:"https://comments.iamlm.com/",visitor:!0})</script></div></div></div></div><script src=https://cdn.staticfile.org/jquery/3.6.0/jquery.min.js></script>
<script defer src=https://iamlm.com/js/laomai.min.b185718dcc7e0011e0f6e3ca17f13e9492d8ea286c14f7bad0c8a9ba0b6c64741e77b66fab6e45ea4d37c39fe5a787447eb5f0160e70b7be5996d2925768bf9a.js integrity="sha512-sYVxjcx+ABHg9uPKF/E+lJLY6ihsFPe60MipugtsZHQed7Zvq25F6k03w5/lp4dEfrXwFg5wt75ZltKSV2i/mg==" crossorigin=anonymous async></script>