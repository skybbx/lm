<!doctype html><html lang=zh-cn><meta charset=utf-8><meta name=renderer content="webkit"><meta name=force-rendering content="webkit"><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><link rel=preconnect href=https://cdn.staticfile.org><meta http-equiv=x-dns-prefetch-control content="on"><link rel=dns-prefetch href=//cdn.staticfile.org><link rel=preload href=/font/notoserifsc-regular-webfont.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/font/merriweather-regular-webfont.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/font/notoserifsc-regular-webfont.woff as=font type=font/woff crossorigin><link rel=preload href=/font/merriweather-regular-webfont.woff as=font type=font/woff crossorigin><title>Waline评论之修改记录</title><meta name=description content="一个简单的博客，一个平凡的博主，用最扑实的话记录最真实的自己！"><meta name=author content="老麦"><link rel=stylesheet href=https://iamlm.com/css/laomai.min.9f5432ecf44d7e71eed167ce1267011fc3a5c67388a213fe6a35d02b69539e8a.css integrity="sha256-n1Qy7PRNfnHu0WfOEmcBH8OlxnOIohP+ajXQK2lTnoo=" rel="preload stylesheet" as=style><link rel=stylesheet href=https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css><body style=background:url(https://laomai.org/wp-content/uploads/2022/04/sea-gc05b59c74_1920.jpg);background-size:cover;background-attachment:fixed><div class=container><div class=main-container><div class=tabs-main><input type=checkbox id=menu-btn>
<label for=menu-btn class=menu-icon><i class="fa fa-bars" aria-hidden=true></i></label><div class=main-header><div class=logo><img src=https://laomai.org/wp-content/uploads/2021/04/apple-touch-icon.png alt=老麦></div><div class=logo-con><p>一个简单的博客，一个平凡的博主，用最扑实的话记录最真实的自己！</div><div class=line1></div></div><div class=menu><ul class=tabs><li class=menu-item><a href=/>首页</a><li class=menu-item><a href=/archives/>文章</a><li class=menu-item><a href=/bb/>闲言</a><li class=menu-item><a href=/about/>关于</a><li class=menu-item><a href=/links/>友链</a></ul></div><div class=post-toc><nav id=TableOfContents><ol><li><a href=#waline评论昵称不能少于3个字符>Waline评论昵称不能少于3个字符</a><ol><li><a href=#环境准备>环境准备</a><li><a href=#重构waline-client>重构Waline Client</a><li><a href=#引用新的客户端>引用新的客户端</a></ol><li><a href=#gravatar头像>Gravatar头像</a><ol><li><a href=#waline上更换头像cdn>Waline上更换头像CDN</a><li><a href=#wordpress上更换头像cdn>Wordpress上更换头像CDN</a></ol></ol></nav></div><div class=main-footer><p>&copy;2022老麦</div></div><div class=main-content><div class=content-header><h1>Waline评论之修改记录</h1></div><div class=line2><div class=post-time><time datetime=2021-08-15T00:00:00>2021-08-15</time></div></div><div class=content><p>依稀记得2016年中时我购买了人生第一台（也是唯一一台）锤子手机——Smartisan T2。当时是受了一个同事的蛊惑，但使用没多久就在一次醉酒后丢失了。与锤子手机的这次短暂相会，让我知道了一个折腾牛人，就是锤子科技的创始人——罗永浩。<blockquote><p>我不是为了输赢，我就是认真。</blockquote><p>《生命不息 折腾不止》——当你试图放弃一个你知道是正确的事情的时候，希望你能看看这本书。这是一个理想主义者的奋斗。<p>也许受老罗影响吧，一直以来我都挺爱折腾的。<h2 id=waline评论昵称不能少于3个字符>Waline评论昵称不能少于3个字符</h2><p>部署好Waline后我在本地测试时发现一个个人觉得比较奇怪的问题，我输入昵称“老麦”并进行评论时提示一个错误，「昵称不能少于3个字符」。老实说，这个我还是有点不能理解的，Waline作者不知为何会作出这样的限制，毕竟用两个中文字作为昵称的人还是很多的。<p>试图在官方文档里找这个配置参数，无果，只好选择重新构建Client。<h3 id=环境准备>环境准备</h3><p>安装<a href=https://nodejs.org/en/ target=_blank rel=noopener>Node.js (nodejs.org)</a>，打开官网我们可以找到两个版本进行安装，一个是<code>14.17.5 LTS</code>，另外一个版本则是<code>16.6.2 Current</code>，虽然Node 14默认使用npm@v6，但还是建议安装LTS版本，毕竟稳定才是王道。由于Waline需要用到npm@v7版本，所以如果安装<code>14.17.5 LTS</code>，我们还需要更新一下npm的版本。<div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>npm i -g npm
</span></span></code></pre></table></div></div><p><strong>拉取项目：</strong><div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git clone https://github.com/walinejs/waline.git
</span></span></code></pre></table></div></div><p><strong>安装依赖：</strong><div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>// 进入项目目录
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> waline
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// 安装项目依赖
</span></span><span style=display:flex><span>npm i
</span></span></code></pre></table></div></div><h3 id=重构waline-client>重构Waline Client</h3><div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>// 进入Client目录
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> ./packages/client/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// 用VSCode打开该目录
</span></span><span style=display:flex><span>code .
</span></span></code></pre></table></div></div><p>打开<code>\src\components\CommentBox.vue</code>，搜索<code>// check nick</code>；<div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vue data-lang=vue><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// check nick
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>          <span style=color:#000;font-weight:700>(</span><span style=color:#000>requiredMeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>indexOf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;nick&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span> <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#000>comment</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>nick</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span>
</span></span><span style=display:flex><span>          <span style=color:#000>comment</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>nick</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>length</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>3</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#000>inputRefs</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>value</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>nick</span><span style=color:#ce5c00;font-weight:700>?</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>focus</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span>          <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>alert</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>locale</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>value</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>nickError</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></table></div></div><p>将<code>comment.nick.length &lt; 3</code>修改成<code>comment.nick.length &lt; 2</code>，保存；<p>运行<code>npm run build</code>，这样Waline的客户端就完成构建了。<h3 id=引用新的客户端>引用新的客户端</h3><p>方法很简单，将生成目录<code>dist</code>里的文件git push到Github上，套上Jsdelivr就可以直接引用了。<div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span></code></pre><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// hugo-theme-stack 默认的引入代码
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#000>script</span> <span style=color:#000>src</span><span style=color:#000;font-weight:700>=</span><span style=color:#a40000>&#39;</span><span style=color:#8f5902;font-style:italic>//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js&#39;&gt;&lt;/script&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#000>div</span> <span style=color:#000>id</span><span style=color:#000;font-weight:700>=</span><span style=color:#4e9a06>&#34;waline&#34;</span> <span style=color:#000>class</span><span style=color:#000;font-weight:700>=</span><span style=color:#4e9a06>&#34;waline-container&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#000>style</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>.</span><span style=color:#000>waline</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>container</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>background</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>color</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>var</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>--</span><span style=color:#000>card</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>background</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>border</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>radius</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>var</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>--</span><span style=color:#000>card</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>border</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>radius</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>box</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>shadow</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>var</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>--</span><span style=color:#000>shadow</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>l1</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>padding</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>var</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>--</span><span style=color:#000>card</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>padding</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>.</span><span style=color:#000>waline</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>container</span> <span style=color:#000;font-weight:700>.</span><span style=color:#000>vcount</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>color</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>var</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>--</span><span style=color:#000>card</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>text</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>main</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>style</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{{</span><span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>with</span> <span style=color:#000;font-weight:700>.</span><span style=color:#000>Site</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Params</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>comments</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>waline</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000;font-weight:700>}}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{{</span><span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#a40000>$</span><span style=color:#000>config</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>dict</span> <span style=color:#4e9a06>&#34;el&#34;</span> <span style=color:#4e9a06>&#34;#waline&#34;</span> <span style=color:#4e9a06>&#34;dark&#34;</span> <span style=color:#4e9a06>`html[data-scheme=&#34;dark&#34;]`</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000;font-weight:700>}}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{{</span><span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#a40000>$</span><span style=color:#000>replaceKeys</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>dict</span> <span style=color:#4e9a06>&#34;serverurl&#34;</span> <span style=color:#4e9a06>&#34;serverURL&#34;</span> <span style=color:#4e9a06>&#34;requiredmeta&#34;</span> <span style=color:#4e9a06>&#34;requiredMeta&#34;</span> <span style=color:#4e9a06>&#34;wordlimit&#34;</span> <span style=color:#4e9a06>&#34;wordLimit&#34;</span> <span style=color:#4e9a06>&#34;pagesize&#34;</span> <span style=color:#4e9a06>&#34;pageSize&#34;</span> <span style=color:#4e9a06>&#34;avatarcdn&#34;</span> <span style=color:#4e9a06>&#34;avatarCDN&#34;</span> <span style=color:#4e9a06>&#34;avatarforce&#34;</span> <span style=color:#4e9a06>&#34;avatarForce&#34;</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000;font-weight:700>}}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{{</span><span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#204a87;font-weight:700>range</span> <span style=color:#a40000>$</span><span style=color:#000>key</span><span style=color:#000;font-weight:700>,</span> <span style=color:#a40000>$</span><span style=color:#000>val</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000;font-weight:700>.</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000;font-weight:700>}}</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>{{</span><span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#204a87;font-weight:700>if</span> <span style=color:#a40000>$</span><span style=color:#000>val</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000;font-weight:700>}}</span>  
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>{{</span><span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#a40000>$</span><span style=color:#000>replaceKey</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>index</span> <span style=color:#a40000>$</span><span style=color:#000>replaceKeys</span> <span style=color:#a40000>$</span><span style=color:#000>key</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000;font-weight:700>}}</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>{{</span><span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#a40000>$</span><span style=color:#000>k</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87;font-weight:700>default</span> <span style=color:#a40000>$</span><span style=color:#000>key</span> <span style=color:#a40000>$</span><span style=color:#000>replaceKey</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000;font-weight:700>}}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>{{</span><span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#a40000>$</span><span style=color:#000>config</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>merge</span> <span style=color:#a40000>$</span><span style=color:#000>config</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>dict</span> <span style=color:#a40000>$</span><span style=color:#000>k</span> <span style=color:#a40000>$</span><span style=color:#000>val</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000;font-weight:700>}}</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>{{</span><span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>end</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000;font-weight:700>}}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{{</span><span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>end</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000;font-weight:700>}}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#000>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>/// Waline client configuration see: https://waline.js.org/en/reference/client.html
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>new</span> <span style=color:#000>Waline</span><span style=color:#000;font-weight:700>({{</span> <span style=color:#a40000>$</span><span style=color:#000>config</span> <span style=color:#000;font-weight:700>|</span> <span style=color:#000>jsonify</span> <span style=color:#000;font-weight:700>|</span> <span style=color:#000>safeJS</span> <span style=color:#000;font-weight:700>}});</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{{</span><span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>end</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000;font-weight:700>}}</span>
</span></span></code></pre></table></div></div><p>将第一行修改为<code>&lt;script src='//cdn.jsdelivr.net/gh/skybbx/img/waline/Waline.min.js'>&lt;/script></code>即可，更多引用方法可以参考官方文档：<a href=https://waline.js.org/guide/client/import.html target=_blank rel=noopener>引入客户端 | Waline</a>。<p>如果你跟我一样只需修改这个昵称字符判定，可以直接引用我修改后的客户端。<p>CDN地址为：<a href=https://cdn.jsdelivr.net/gh/skybbx/img/waline/ target=_blank rel=noopener>https://cdn.jsdelivr.net/gh/skybbx/img/waline/</a><h2 id=gravatar头像>Gravatar头像</h2><p>Gravatar由于被qiang的关系，一直以来我都是使用极客CDN的代理，表现很稳定，可最近这两天却发现开始出问题了，经常出现加载不了的情况。好在这种代理有很多大佬在做，既然不稳定就换一个吧。这次看中的是老庞做的代理。传送门：<a href=https://blog.loli.top/archives/1023.html target=_blank rel=noopener>自建Gravatar国内+全球镜像加速服务 | 城南旧事 (loli.top)</a><h3 id=waline上更换头像cdn>Waline上更换头像CDN</h3><p>因为Waline上Gravatar头像默认的CDN就是极客的，修改方法很简单，查看官方文档——<a href=https://waline.js.org/reference/client.html target=_blank rel=noopener>前端配置 | Waline</a>，定义一个配置<code>avatarCDN</code>即可。案例：<div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#000>script</span> <span style=color:#000>src</span><span style=color:#000;font-weight:700>=</span><span style=color:#4e9a06>&#34;//cdn.jsdelivr.net/gh/skybbx/img/waline/Waline.min.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#000>div</span> <span style=color:#000>id</span><span style=color:#000;font-weight:700>=</span><span style=color:#4e9a06>&#34;waline&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#000>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>new</span> <span style=color:#000>Waline</span><span style=color:#000;font-weight:700>({</span>
</span></span><span style=display:flex><span>    <span style=color:#000>el</span><span style=color:#000;font-weight:700>:</span> <span style=color:#a40000>&#39;#</span><span style=color:#000>waline</span><span style=color:#a40000>&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>serverURL</span><span style=color:#000;font-weight:700>:</span> <span style=color:#a40000>&#39;</span><span style=color:#000>客户端地址</span><span style=color:#a40000>&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>copyright</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>requiredMeta</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span><span style=color:#a40000>&#39;</span><span style=color:#000>nick</span><span style=color:#a40000>&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#a40000>&#39;</span><span style=color:#000>mail</span><span style=color:#a40000>&#39;</span><span style=color:#000;font-weight:700>],</span>
</span></span><span style=display:flex><span>    <span style=color:#000>avatarCDN</span><span style=color:#000;font-weight:700>:</span> <span style=color:#a40000>&#39;</span><span style=color:#000>https</span><span style=color:#000;font-weight:700>:</span><span style=color:#8f5902;font-style:italic>//gravatar.loli.top/avatar/&#39;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></table></div></div><p>另：可以用<code>{ $config | jsonify | safeJS }</code>将前端的配置集成到Config里。<h3 id=wordpress上更换头像cdn>Wordpress上更换头像CDN</h3><p>将下面代理添加到主题的functions.php即可。<div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// gravatar使用 CDN
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>function</span> <span style=color:#000>replace_gravatar</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$avatar</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span><span style=color:#000>$avatar</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>str_replace</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>array</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;//gravatar.com/&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;//secure.gravatar.com/&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;//www.gravatar.com/&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;//0.gravatar.com/&#34;</span><span style=color:#000;font-weight:700>,</span> 
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;//1.gravatar.com/&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;//2.gravatar.com/&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;//cn.gravatar.com/&#34;</span><span style=color:#000;font-weight:700>),</span> <span style=color:#4e9a06>&#34;//gravatar.loli.top/&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>$avatar</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>$avatar</span><span style=color:#000;font-weight:700>;}</span>
</span></span><span style=display:flex><span><span style=color:#000>add_filter</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#39;get_avatar&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;replace_gravatar&#39;</span> <span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></table></div></div></div><div class="content-tags ahover"><ul><li><a href=/tags/hugo>#hugo</a><li><a href=/tags/waline>#waline</a><li><a href=/tags/stack>#stack</a><li><a href=/tags/jsdelivr>#jsdelivr</a><li><a href=/tags/cdn>#cdn</a><li><a href=/tags/nodejs>#nodejs</a><li><a href=/tags/gravatar>#gravatar</a><li><a href=/tags/npm>#npm</a><li><a href=/tags/wordpress>#Wordpress</a></ul></div><div class=content-footer><script src=//cdn.jsdelivr.net/npm/@waline/client></script><div id=waline class=waline-container></div><style>:root{--waline-font-size:1rem;--waline-theme-color:rgba(0,0,0,0.7);--waline-active-color:#202020;--waline-badge-color:rgba(0,0,0,0.3)}.v[data-class=v] .vcard .vhead .vnick svg{display:none}.v[data-class=v] .vpower{display:none}</style><script>new Waline({avatarCDN:"https://sdn.geekzu.org/avatar/",dark:'html[data-scheme="dark"]',el:"#waline",emoji:["https://cdn.jsdelivr.net/gh/walinejs/emojis/weibo"],lang:"zh-cn",locale:{admin:"⭐"},placeholder:"在这里分享您的观点与想法，昵称、邮箱必填，邮件通知回复。",requiredMeta:["nick","mail"],serverURL:"https://comments.iamlm.com/",visitor:!0})</script></div></div></div></div><script src=https://cdn.staticfile.org/jquery/3.6.0/jquery.min.js></script>
<script defer src=https://iamlm.com/js/laomai.min.b185718dcc7e0011e0f6e3ca17f13e9492d8ea286c14f7bad0c8a9ba0b6c64741e77b66fab6e45ea4d37c39fe5a787447eb5f0160e70b7be5996d2925768bf9a.js integrity="sha512-sYVxjcx+ABHg9uPKF/E+lJLY6ihsFPe60MipugtsZHQed7Zvq25F6k03w5/lp4dEfrXwFg5wt75ZltKSV2i/mg==" crossorigin=anonymous async></script>